# IndexAll - UI/UX 设计（Phase 1 MVP）

## 核心用户流程

### Flow 1：按标签浏览资源

```
打开 IndexAll → 看到标签树 → 点击标签 → 右侧显示该标签下的资源（含子标签） → 点击资源 → 跳转到原始页面
```

### Flow 2：搜索资源

```
打开 IndexAll → 在搜索栏输入关键词 → 实时展示匹配结果（按标题/描述/标签名/别名匹配） → 点击资源 → 跳转
```

### Flow 3：手动添加资源

```
点击"添加"按钮 → 弹窗填写 URL、标题、描述 → 选择标签（支持搜索/新建） → 保存
```

### Flow 4：浏览器扩展收藏

```
在任意网页 → 点击扩展图标 → 弹窗自动填入标题和 URL → 选择/新建标签 → 点击保存 → 完成
```

### Flow 5：管理标签

```
在标签树中 → 右键标签 → 编辑（改名/加别名/调整父标签）/ 删除 / 新建子标签
```

---

## Web UI 页面结构

只有一个主页面，所有操作在同一视图内完成，不做路由跳转。

### 整体布局

```
┌─────────────────────────────────────────────────────────────────┐
│  Logo/IndexAll          🔍 搜索资源...              [+ 添加资源] │
├─────────────────┬───────────────────────────────────────────────┤
│                 │                                               │
│   标签树面板     │   资源列表                                     │
│   (可折叠)      │                                               │
│                 │   ┌─────────────────────────────────────────┐ │
│   全部资源  (42) │   │  📄 React Documentation                 │ │
│   未分类    (5)  │   │  https://react.dev                     │ │
│                 │   │  前端 · React · 框架                     │ │
│   ▼ 前端        │   │  来源: 手动添加 · 2026-02-06             │ │
│     React       │   └─────────────────────────────────────────┘ │
│     Vue         │                                               │
│     CSS         │   ┌─────────────────────────────────────────┐ │
│   ▼ 后端        │   │  📄 Hono - Web Framework                │ │
│     Node.js     │   │  https://hono.dev                       │ │
│     Go          │   │  后端 · Node.js · 框架                   │ │
│   ▶ 工具        │   │  来源: 手动添加 · 2026-02-05             │ │
│   ▶ 设计        │   └─────────────────────────────────────────┘ │
│                 │                                               │
│   ──────────    │   ┌─────────────────────────────────────────┐ │
│   [+ 新建标签]   │   │  ...更多资源                             │ │
│                 │   └─────────────────────────────────────────┘ │
│                 │                                               │
│                 │                          共 12 条 · 第 1/2 页  │
├─────────────────┴───────────────────────────────────────────────┤
│                                                          状态栏  │
└─────────────────────────────────────────────────────────────────┘
```

### 区域说明

#### 顶栏

- **Logo**：左侧固定
- **搜索栏**：居中，全局搜索入口，输入即搜（debounce），搜索范围覆盖标题、描述、标签名、标签别名
- **添加按钮**：右侧，点击弹出添加资源的对话框

#### 左侧：标签树面板

- 默认展开，可折叠（移动端自动折叠为抽屉）
- 顶部固定两个虚拟节点：
  - **全部资源**：显示总数，点击清除标签筛选
  - **未分类**：没有任何标签的资源
- 标签以树形结构渲染（DAG 中一个标签可能出现在多个位置，以首个父标签为主位置，其余位置显示为引用样式）
- 每个标签右侧显示资源计数（含子标签递归计数）
- 点击标签 → 右侧列表筛选为该标签及其子标签下的资源
- 右键菜单：编辑 / 删除 / 新建子标签
- 底部：[+ 新建标签] 按钮

#### 右侧：资源列表

- 默认显示全部资源，按添加时间倒序
- 选中标签后，显示该标签（含子标签）下的资源
- 搜索时，显示搜索结果
- 每条资源卡片展示：
  - 标题（可点击，跳转到原始 URL）
  - URL（灰色小字）
  - 标签列表（彩色标签胶囊，可点击跳转到该标签筛选）
  - 来源 + 时间
- 资源卡片 hover 时显示操作按钮：编辑 / 删除
- 底部分页

---

## 对话框 / 弹窗

### 添加/编辑资源对话框

```
┌──────────────────────────────────────────┐
│  添加资源                            ✕   │
├──────────────────────────────────────────┤
│                                          │
│  URL                                     │
│  ┌────────────────────────────────────┐  │
│  │ https://                           │  │
│  └────────────────────────────────────┘  │
│                                          │
│  标题                                    │
│  ┌────────────────────────────────────┐  │
│  │                                    │  │
│  └────────────────────────────────────┘  │
│                                          │
│  描述（可选）                             │
│  ┌────────────────────────────────────┐  │
│  │                                    │  │
│  │                                    │  │
│  └────────────────────────────────────┘  │
│                                          │
│  标签                                    │
│  ┌────────────────────────────────────┐  │
│  │ 🔍 搜索或新建标签...               │  │
│  └────────────────────────────────────┘  │
│  [前端] [React] [框架]         ← 已选标签 │
│                                          │
│              [取消]    [保存]             │
└──────────────────────────────────────────┘
```

- URL 输入后可自动抓取标题（后端 fetch og:title / document.title）
- 标签选择器：输入即搜索已有标签（含别名匹配），搜不到时显示"新建标签: xxx"选项
- 编辑模式复用同一对话框，预填已有数据

### 编辑标签对话框

```
┌──────────────────────────────────────────┐
│  编辑标签                            ✕   │
├──────────────────────────────────────────┤
│                                          │
│  名称                                    │
│  ┌────────────────────────────────────┐  │
│  │ React                              │  │
│  └────────────────────────────────────┘  │
│                                          │
│  别名（回车添加）                         │
│  ┌────────────────────────────────────┐  │
│  │ ReactJS, React.js                  │  │
│  └────────────────────────────────────┘  │
│  [ReactJS] [React.js]          ← 已有别名│
│                                          │
│  父标签                                  │
│  ┌────────────────────────────────────┐  │
│  │ 🔍 搜索父标签...                   │  │
│  └────────────────────────────────────┘  │
│  [前端] [框架]                 ← 已选父级 │
│                                          │
│              [取消]    [保存]             │
└──────────────────────────────────────────┘
```

- 父标签支持多选（DAG），搜索已有标签
- 新建标签时也使用此对话框（名称为空）

---

## 浏览器扩展

### 弹窗（Popup）

点击扩展图标时弹出，紧凑布局：

```
┌────────────────────────────────┐
│  IndexAll                      │
├────────────────────────────────┤
│                                │
│  React Documentation           │  ← 自动抓取，可编辑
│  https://react.dev             │  ← 自动填入，灰色
│                                │
│  ┌──────────────────────────┐  │
│  │ 🔍 添加标签...            │  │
│  └──────────────────────────┘  │
│  [前端] [React]                │  ← 已选标签
│                                │
│  [      保存到 IndexAll      ] │
│                                │
│  ✓ 已保存 3 条到此站点          │  ← 提示该域名下已收藏的数量
└────────────────────────────────┘
```

#### 交互细节

- 打开弹窗时自动填入当前页面标题和 URL
- 如果当前页面已收藏过，显示已有标签，按钮变为"更新"
- 标签选择器：与 Web UI 一致，支持搜索 + 新建
- 保存后显示成功提示，1 秒后自动关闭或保持
- 底部提示该域名下已收藏数量，点击可跳转到 Web UI 查看

---

## 关键交互模式

### 标签选择器（Tag Picker）

全局复用的核心组件，用于资源添加/编辑、扩展弹窗等场景。

```
输入框: [Rea|]
┌──────────────────────────┐
│  React              前端  │  ← 匹配标签名
│  React Native      移动端 │  ← 匹配标签名
│  ReactJS        → React   │  ← 匹配别名，显示指向
│  ─────────────────────── │
│  + 新建标签 "Rea"         │  ← 无精确匹配时出现
└──────────────────────────┘
```

- 输入即搜索，匹配标签名和别名
- 显示每个标签的第一个父标签作为上下文提示
- 已选标签以胶囊形式展示在输入框下方，可点击 x 移除
- 选择后输入框清空，焦点保留，可继续添加
- 回车选中第一个匹配项

### 标签树中的 DAG 展示

DAG 结构中一个标签可以有多个父标签，在树形视图中**平等展示**，不区分主次：

```
▼ 前端
    React              ← 同时属于"前端"和"框架"
    Vue
▼ 框架
    React              ← 与上面是同一个标签，无任何视觉区分
    Express
```

- 同一个标签在所有父标签下平等出现，不做主位置/引用的区分
- 点击任何一个位置效果一致，都是筛选同一个标签
- hover 时 tooltip 提示"此标签同时属于: 前端、框架"，帮助用户理解 DAG 关系

### 搜索行为

- 全局搜索栏输入时，实时筛选（debounce 300ms）
- 搜索时左侧标签树的选中状态清除，右侧显示搜索结果
- 搜索结果高亮匹配的字段（标题/描述/标签名）
- 清空搜索栏时，恢复之前的标签筛选状态

---

## 响应式适配

| 视口 | 布局 |
|---|---|
| 桌面 (≥1024px) | 左右分栏，标签树常驻 |
| 平板 (768-1023px) | 标签树折叠为侧边抽屉，点击汉堡菜单展开 |
| 手机 (<768px) | 标签树为全屏抽屉，资源列表单栏显示 |
